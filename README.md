# TangAgent

## TangAgent是什么

`TangAgent`是一款Stratum Proxy系统，并集成数据采集、监控、告警等服务。应用于各种规模的矿场，可极大节省带宽需求，提高矿机集群的稳定性，是大中型矿场不可或缺的优秀管理平台。

## 主要特性
* 极大地降低出口带宽
  * 通常几千至数万台矿机规模的矿场，对于出口带宽的需求是20Mb~50Mb的专用光纤，所有矿机通信的数据均走该通道，而将`TangAgent`部署于矿场内部，矿场内部矿机均与`TangAgent`直接通信，转化为内部流量。此时整个矿场仅`TangAgent`与外部矿池通信，甚至[2Mb的ADSL即可满足](http://bbs.tangpool.com/forum.php?mod=viewthread&tid=3&fromuid=3)。
* 提升矿场整体稳定性
  * 矿机不再走广域网通信，而是走内部局域网，极大发挥内网百兆/千兆的优势，同时，广域网的各种线路故障、拥塞等问题均不会影响到矿场内部的矿机。
* 强大的监控与运维
  * 自动收集矿场内部矿机的状态，并发送至唐池后台服务统一处理（严格控制带宽，上报状态约占带宽10Kb~50Kb）。
  * 提供Web界面，告警，统计等服务，方便运维人员管理，单人可以运维数千台矿机，提高效率节省开销。

## 部署方式

### 方式一、局域网部署

将运行`TangAgent`的服务器放置与矿机同一局域网内，所有矿机的矿池均设置为该机器，该机器连接上行矿池。

### 方式二、广域网部署

若矿场出口带宽与矿池通信不畅(如连接Ghash.io等)，可以将`TangAgent`部署在IDC机房，或者云服务商（如阿里云、青云等），借助他们的高质量带宽与上行矿池连接。同时，矿场的矿机与这些服务商连接走国内网络，通常也可保持低延迟，达到较高稳定性。

## 部署要求

### 硬件要求

 硬件 | 最低配置 | 中小型矿场推荐配置 | 大型矿场推荐配置
-----|---------|-----------------|-------------------
内存 | 1G | 4G | 8G
CPU | Intel i3 | Intel i5 X 2(4/8核) | Intel Xeon E5 X 2(8/16核)
磁盘 | 5G | 500G | 128G(SSD)

总体而言，对硬件要求较低，低预算可购买稳定的二手品牌服务器。处于稳定性考虑，通常部署2台`TangAgent`，一主一备，防止硬件故障带来的巨大损失。

### 带宽要求

* 上行：2Mbps+，推荐4Mb~10Mb的光纤带宽。主要用于与上行矿池通信
* 下行：视带的矿机数量而定：1000台机器峰峰值约10Mbps、均值1Mbps。故百兆局域网可以带1万台矿机

### 上行矿池要求

无。

### 矿机要求

`TangAgent`有两种工作模式，取决与矿机的最高速度：若矿机算力大于2Ths，则带机数量不得高于250台，可以申请多个AgentId，部署多个`TangAgent`在不同端口；若矿机算力低于2Ths，则带机数量不得高于6万台。

### 网络拓扑

若小型矿场，网络拓扑通常是二层结构：1. 接入交换层 2. 路由层。`TangAgent`可部署在任意的网络接入点，因对带宽需求低，任意节点均可充分满足。

若大中型矿场，网络拓扑通常是三/四层结构：1. 接入交换层（百兆） 2. 汇聚交换层（百/千兆） 3. 核心交换层（千兆） 4. 路由层。此时，应把`TangAgent`部署在“汇聚交换层”或者“核心交换层”，保障发挥千兆的高带宽优势，减少数据物理链路。

## 常见问题

### Q：是否支持来特币矿场？

    A：目前仅支持比特币采矿的矿场，未来将支持莱特币。

### Q：该服务是否收费？

    A：免费，不收取任何费用。若购买硬件，或需官方提供技术支持，酌情收取一定费用。
